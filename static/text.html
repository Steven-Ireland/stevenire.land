<!DOCTYPE html>
<html>
<head>
<title>Hello</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: black;
}
</style>
</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(30, window.innerWidth / window.innerHeight, 0.1, 2000);
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const ambientLight = new THREE.AmbientLight(0x606060, 0.6);
scene.add(ambientLight);
const light = new THREE.PointLight(0xffffff, 1.0);
light.position.set(0, 0, 1200);
scene.add(light);

const urlParams = new URLSearchParams(window.location.search);
const encoded = urlParams.get('q');
const text = encoded ? atob(encoded) : 'HELLO';

const loader = new THREE.FontLoader();
loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function(font) {
  const geometry = new THREE.TextGeometry(text, {
    font: font,
    size: 150,
    height: 40,
    curveSegments: 24,
    bevelEnabled: true,
    bevelThickness: 4,
    bevelSize: 2,
    bevelOffset: 0,
    bevelSegments: 5
  });
  geometry.center();
  const material = new THREE.MeshPhongMaterial({ color: 0xffffff, shininess: 100 });
  const textMesh = new THREE.Mesh(geometry, material);
  const box = new THREE.Box3().setFromObject(textMesh);
  const textWidth = box.max.x - box.min.x;
  const maxWidth = window.innerWidth * 0.4;
  const scale = Math.min(1, maxWidth / textWidth);
  textMesh.scale.set(scale, scale, scale);
  textMesh.position.set(0, 0, -200);
  textMesh.rotation.y = Math.PI / 12;
  textMesh.rotation.x = -Math.PI / 16;
  scene.add(textMesh);

  camera.position.z = 1050;

  let progress = 0;
  let entered = false;
  const animate = function () {
    requestAnimationFrame(animate);
    if (!entered) {
      progress += 0.0005;
      if (progress >= 1) {
        progress = 1;
        entered = true;
        textMesh.position.set(0, 0, 1050);
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = 'Enter new word';
        input.style.position = 'absolute';
        input.style.top = '50%';
        input.style.left = '50%';
        input.style.transform = 'translate(-50%, -50%)';
        input.style.fontSize = '24px';
        input.style.padding = '10px';
        input.style.textAlign = 'center';
        input.style.background = 'rgba(0,0,0,0.5)';
        input.style.color = 'white';
        input.style.border = '1px solid white';
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            window.location.search = '?q=' + btoa(input.value.toUpperCase());
          }
        });
        document.body.appendChild(input);
        input.focus();
      }
      const eased = 1 - Math.pow(1 - progress, 3);
      textMesh.position.z = -800 + 2000 * eased;
      textMesh.rotation.x = -Math.PI / 16 + (Math.PI / 12) * eased;
      textMesh.rotation.y = Math.PI / 12 + (Math.PI / 12) * eased;
      textMesh.rotation.z = (Math.PI / 12) * eased;
      let blur = 0;
      if (progress < 0.2) {
        blur = (0.2 - progress) * 10;
      } else if (progress > 0.3) {
        blur = (progress - 0.3) * 10;
      }
      renderer.domElement.style.filter = `blur(${blur}px)`;
    } else {
      renderer.domElement.style.filter = 'blur(0px)';
    }
    renderer.render(scene, camera);
  };
  animate();
});


</script>
</body>
</html>
